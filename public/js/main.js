function defineHeight(e){return $(e).outerHeight(!0)}function defineLineHeight(e){return parseInt($(e).css("lineHeight"),10)}function defineNumbersOfLines(e,t){return e/t}function buildLine(e){var t,n,a;t=defineNumbersOfLines(defineHeight(e),defineLineHeight(e)),n=$(document.createDocumentFragment()),appendClass=$(".js-code__numbers");for(var o=1;t>=o;o++)a=o+"<br>",n.append(a);$(appendClass).html(n)}function defineColors(e,t,n){for(var a=0;a<$(t).length;a++)n.call($(t)[a],a)}function dataFilter(e,t,n){return $(e).filter(function(e,a){return $(a).data(t)===n})}function startFixPanel(){"use strict";var e=window.pageYOffset||document.documentElement.scrollTop,t=$(".support").offset().top,n=($(window).height(),document.querySelector(".sticky"));e>=t?n.classList.add("sticky_fixed"):n.classList.remove("sticky_fixed"),e>=t+$(".support").height()-48&&n.classList.remove("sticky_fixed")}function buildOnCnahge(e){buildLine(dataFilter(".code__language_show .js-code__content","converter",e)),dataFilter(".converter__state","converter",e).addClass("converter__state_active")}var parseObj=[{str:["[0,1],","NULL"],className:"code__color-purple"},{str:['""',,'(@|L)"(.)+'],className:"code__color-green"},{str:["new","ref","out","void","Dim","As"],className:"code__color-blue"},{str:[" = ::","<br>::"," = "," -","-*&(gt|amp);","[*]"],className:"code__color-brown"},{str:[",","([.]|[(])|[{]|[}]","[)];",";$"],className:"code__color-gray"},{str:["MFFrameCreateFromMem","WriterSet","ReceiverFramePut","ReaderOpen","SourceFrameGet","WriterSet","CoCreateInstance","__uuidof","SysAllocString","Release","ReaderClose"],className:"code__color-red"}];$(function(){startFixPanel(),window.onscroll=function(){startFixPanel()},defineColors(parseObj,".js-code__content",function(e){for(var t,n,a=$(this),o=0;o<parseObj.length;o++)parseObj[o].str.forEach(function(e){t=new RegExp(e,"gm"),n=a.html().replace(t,function(e){return"<span class="+parseObj[o].className+">"+e+"</span>"}),a.html(n)})}),buildLine(".code__content_show"),$(".js-converter__checkbox").change(function(){var e;$(".converter__state").removeClass("converter__state_active"),$(".code__content").toggleClass("code__content_show"),$(".code__body").animate({height:defineHeight(".code__language_show")},500),e=this.checked?"encoding":"coding",buildOnCnahge(e)}),$(".js-btn__language").click(function(){$(".js-btn__language").removeClass("btn_active"),$(this).addClass("btn_active"),$(".js-code__language").removeClass("code__language_show"),dataFilter(".js-code__language","language",$(this).data("language")).addClass("code__language_show"),buildLine(".code__language_show .code__content_show"),$(".code__body").animate({height:defineHeight(".code__language_show")},500)}),$(".js-show-next").click(function(e){e.preventDefault(),$(this).next().slideToggle(800)}),$(".support__headline").click(function(){$(this).find(".support__arrow").toggleClass("support__arrow_close"),$(this).last()&&$(this).toggleClass("support__headline_last")})});